# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞

## üéØ –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞
–≠—Ç–æ Telegram –±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞—è–≤–∫–∞–º–∏ –Ω–∞ –ø–æ–µ–∑–¥–∫–∏ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Bitrix24 CRM. –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –≥—Ä—É–ø–ø–µ –≤–æ–¥–∏—Ç–µ–ª–µ–π –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞—è–≤–∫–∏ —á–µ—Ä–µ–∑ webhook'–∏.

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç—ã

### 1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–ù–ò–ö–û–ì–î–ê** –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—Ç–æ–∫–µ–Ω—ã, –ø–∞—Ä–æ–ª–∏, API –∫–ª—é—á–∏)
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `config.example.php` –∫–∞–∫ —à–∞–±–ª–æ–Ω
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ `.gitignore` –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–∞–º–∏

### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞
- –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤ `src/botManager.php`
- Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ `src/index.php`
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ `config/config.php` (–Ω–µ –≤ Git!)

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ —Å–Ω–∞—á–∞–ª–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `./scripts/switch_environment.sh test`
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –≤ `logs/` –ø–∞–ø–∫–µ

## üîß –ß–∞—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
1. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ –≤ –∫–ª–∞—Å—Å `botManager`
2. –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ `buttonHandle()` –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
4. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `tail -f logs/error.log`
2. –ù–∞–π—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–æ–±–ª–µ–º—ã
3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–¥
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
5. –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –≤ Git

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
1. –ù–∞–π—Ç–∏ —Ñ—É–Ω–∫—Ü–∏—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (`orderText*`)
2. –ò–∑–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–º–æ–¥–∑–∏ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

## üìä –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

```php
// ID –≥—Ä—É–ø–ø—ã –≤–æ–¥–∏—Ç–µ–ª–µ–π
const DRIVERS_GROUP_CHAT_ID = -1002544521661;

// –°—Ç–∞–¥–∏–∏ —Å–¥–µ–ª–æ–∫
const DRIVER_ACCEPTED_STAGE_ID = 'PREPAYMENT_INVOICE';

// –ü–æ–ª—è Bitrix24
const DRIVER_ID_FIELD = 'UF_CRM_1751185017761';  // Telegram ID –≤–æ–¥–∏—Ç–µ–ª—è
const PASSENGERS_FIELD = 'UF_CRM_1751271798896'; // –ü–∞—Å—Å–∞–∂–∏—Ä—ã
const HIDDEN_FIELD = 'UF_CRM_1751271841129';     // –°–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ
```

## üö® –í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–∞—Å—Å–∞–∂–∏—Ä–æ–≤
- –í –≥—Ä—É–ø–ø–æ–≤–æ–º —á–∞—Ç–µ –ø–∞—Å—Å–∞–∂–∏—Ä—ã **–ù–ï –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è**
- –í –ª–∏—á–∫–µ –≤–æ–¥–∏—Ç–µ–ª—é –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è **–í–°–ï** –ø–∞—Å—Å–∞–∂–∏—Ä—ã —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞–º–∏
- –ü–æ–ª–µ `UF_CRM_1751271841129` **–ù–ò–ö–û–ì–î–ê** –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–æ–¥–∏—Ç–µ–ª–µ–π
- –õ—é–±–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –Ω–∞–∂–∞—Ç—å "–ü—Ä–∏–Ω—è—Ç—å"
- –ï—Å–ª–∏ –≤–æ–¥–∏—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ CRM - –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –µ–º—É
- –ï—Å–ª–∏ –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω - –Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è –∫–æ–Ω—Ç–∞–∫—Ç ID 39
- –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–º—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

### –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- –î–∞—Ç—ã: `d.m.Y H:i` (19.12.2025 11:50)
- –°—É–º–º—ã: —É–±–∏—Ä–∞—Ç—å `|RUB`, –¥–æ–±–∞–≤–ª—è—Ç—å "—Ä—É–±."
- –ù–æ–º–µ—Ä–∞ –∑–∞—è–≤–æ–∫: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `TITLE`, –Ω–µ `ID`

## üîç –û—Ç–ª–∞–¥–∫–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–æ–≤
```php
file_put_contents('/var/www/html/meetRiedeBot/logs/debug.log', 
    date('Y-m-d H:i:s') . " - DEBUG: " . print_r($data, true) . "\n", 
    FILE_APPEND
);
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
```bash
# –õ–æ–≥–∏
tail -f logs/webhook_debug.log

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
php -l src/botManager.php

# –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
./scripts/switch_environment.sh test
```

## üìù –®–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π

### –î–ª—è –≥—Ä—É–ø–ø—ã
```
üöó –í–∞—à–∞ –∑–∞—è–≤–∫–∞ #{TITLE}
üìÜ –î–∞—Ç–∞: {DATE}
üÖ∞Ô∏è –û—Ç–∫—É–¥–∞: {FROM}
üÖ±Ô∏è –ö—É–¥–∞: {TO}
üí∞ –°—É–º–º–∞: {SUM} —Ä—É–±.
```

### –î–ª—è –≤–æ–¥–∏—Ç–µ–ª—è
```
üöó –í–∞—à–∞ –∑–∞—è–≤–∫–∞ #{TITLE}
üìÜ –î–∞—Ç–∞: {DATE}
üÖ∞Ô∏è –û—Ç–∫—É–¥–∞: {FROM}
üÖ±Ô∏è –ö—É–¥–∞: {TO}
üë• –ü–∞—Å—Å–∞–∂–∏—Ä—ã: {PASSENGERS}
üí∞ –°—É–º–º–∞: {SUM} —Ä—É–±.
```

## üéØ –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞
1. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞—è–≤–æ–∫ –Ω–∞ –ø–æ–µ–∑–¥–∫–∏
2. –£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª–µ–π
3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Bitrix24 CRM
4. –ó–∞—â–∏—Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
5. –ù–∞–¥–µ–∂–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 24/7

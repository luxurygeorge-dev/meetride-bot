# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ MeetRide Bot

## üèõÔ∏è –û–±—â–∞—è —Å—Ö–µ–º–∞

```
Bitrix24 CRM ‚Üê‚Üí Webhook ‚Üê‚Üí PHP Bot ‚Üê‚Üí Telegram API
     ‚Üì              ‚Üì         ‚Üì           ‚Üì
  –°–¥–µ–ª–∫–∏/–ö–æ–Ω—Ç–∞–∫—Ç—ã  –°–æ–±—ã—Ç–∏—è  –û–±—Ä–∞–±–æ—Ç–∫–∞  –°–æ–æ–±—â–µ–Ω–∏—è
```

## üì¶ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. Webhook Handler (`src/index.php`)
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –æ—Ç Bitrix24
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç `ONCRMDEALUPDATE` —Å–æ–±—ã—Ç–∏—è
- –í—ã–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞

### 2. Bot Manager (`src/botManager.php`)
- –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Bitrix24 API
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

### 3. Bitrix24 Integration (`src/crest/`)
- REST API –∫–ª–∏–µ–Ω—Ç –¥–ª—è Bitrix24
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ —Å–¥–µ–ª–∫–∞–º–∏ –∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## üîÑ –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏
1. Bitrix24 ‚Üí Webhook ‚Üí `dealChangeHandle()`
2. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
3. –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –≥—Ä—É–ø–ø—É –≤–æ–¥–∏—Ç–µ–ª–µ–π

### –ü—Ä–∏–Ω—è—Ç–∏–µ –∑–∞—è–≤–∫–∏
1. Telegram ‚Üí Callback ‚Üí `buttonHandle()`
2. –ü–æ–∏—Å–∫ –≤–æ–¥–∏—Ç–µ–ª—è –≤ CRM
3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏ –≤ Bitrix24
4. –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–µ—Ç–∞–ª–µ–π –≤ –ª–∏—á–∫—É

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏
1. Bitrix24 ‚Üí Webhook ‚Üí `dealChangeHandle()`
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ–ª–µ–π
3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–æ–≥–æ –≤–æ–¥–∏—Ç–µ–ª—è

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –°–¥–µ–ª–∫–∞ (Deal)
```php
[
    'ID' => '123',
    'TITLE' => '–ó–∞—è–≤–∫–∞ #123',
    'STAGE_ID' => 'PREPARATION',
    'ASSIGNED_BY_ID' => '1',
    'UF_CRM_1751271798896' => '–ü–∞—Å—Å–∞–∂–∏—Ä—ã',
    'UF_CRM_1751185017761' => 'Telegram ID –≤–æ–¥–∏—Ç–µ–ª—è'
]
```

### –ö–æ–Ω—Ç–∞–∫—Ç (Contact)
```php
[
    'ID' => '456',
    'NAME' => '–ò–≤–∞–Ω',
    'LAST_NAME' => '–ü–µ—Ç—Ä–æ–≤',
    'UF_CRM_1751185017761' => '123456789'
]
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –í—Å–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ `config/config.php`
- Webhook –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ `event_handler_id`
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

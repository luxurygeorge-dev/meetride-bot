# üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Webhook'–æ–≤ Bitrix24 –¥–ª—è MeetRide

**–î–∞—Ç–∞:** 7 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ù–ê–°–¢–†–û–ï–ù–û

---

## üìã –ß—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

### ‚úÖ Webhook #1: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ —á–∞—Ç –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ 2-—é —Å—Ç–∞–¥–∏—é

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–∏ —Å–¥–µ–ª–∫–∏ –Ω–∞ —Å—Ç–∞–¥–∏—é "–ü–æ–∏—Å–∫ –≤–æ–¥–∏—Ç–µ–ª—è" (PREPARATION) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Telegram —á–∞—Ç –≤–æ–¥–∏—Ç–µ–ª–µ–π —Å –∫–Ω–æ–ø–∫–∞–º–∏ [–ü—Ä–∏–Ω—è—Ç—å] [–û—Ç–∫–∞–∑–∞—Ç—å—Å—è]

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Bitrix24:**
- **URL:** https://skysoft24.ru/meetRiedeBot/index.php
- **–°–æ–±—ã—Ç–∏–µ:** ONCRMDEALUPDATE (–ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–¥–µ–ª–∫–∏)
- **–§–∏–ª—å—Ç—Ä:** STAGE_ID = PREPARATION
- **Handler ID:** 3 (–¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)

---

### ‚úÖ Webhook #2: –û—Ç–∫–∞—Ç –∑–∞—è–≤–∫–∏ —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ï—Å–ª–∏ —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ —Å—Ç–∞–¥–∏—é PREPARATION –≤–æ–¥–∏—Ç–µ–ª—å –Ω–µ –≤–∑—è–ª –∑–∞—è–≤–∫—É, –æ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ —Å—Ç–∞–¥–∏—é NEW

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ Bitrix24:**
- **URL:** https://skysoft24.ru/meetRiedeBot/index.php
- **–°–æ–±—ã—Ç–∏–µ:** ONCRMDEALUPDATE –∏–ª–∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞
- **–ó–∞–¥–µ—Ä–∂–∫–∞:** 30 –º–∏–Ω—É—Ç
- **–î–µ–π—Å—Ç–≤–∏–µ:** –ï—Å–ª–∏ `ASSIGNED_BY_ID` –ø—É—Å—Ç–æ–π ‚Üí `STAGE_ID` = NEW

---

## üîÑ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –í–æ–¥–∏—Ç–µ–ª—å –≤–∑—è–ª –∑–∞—è–≤–∫—É (—É—Å–ø–µ—Ö)
```
1. –ú–µ–Ω–µ–¥–∂–µ—Ä ‚Üí –°—Ç–∞–¥–∏—è —Å–¥–µ–ª–∫–∏ = PREPARATION
2. Bitrix24 ‚Üí Webhook ‚Üí https://skysoft24.ru/meetRiedeBot/index.php
3. –ë–æ—Ç ‚Üí –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram –≥—Ä—É–ø–ø—É —Å –∫–Ω–æ–ø–∫–∞–º–∏
4. –í–æ–¥–∏—Ç–µ–ª—å ‚Üí –ù–∞–∂–∏–º–∞–µ—Ç [‚úÖ –ü—Ä–∏–Ω—è—Ç—å]
5. –ë–æ—Ç ‚Üí –°—Ç–∞–¥–∏—è = PREPAYMENT_INVOICE
6. Webhook —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç –ù–ï —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç (—É–∂–µ –µ—Å—Ç—å –≤–æ–¥–∏—Ç–µ–ª—å)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ù–∏–∫—Ç–æ –Ω–µ –≤–∑—è–ª –∑–∞—è–≤–∫—É (–æ—Ç–∫–∞—Ç)
```
1. –ú–µ–Ω–µ–¥–∂–µ—Ä ‚Üí –°—Ç–∞–¥–∏—è —Å–¥–µ–ª–∫–∏ = PREPARATION
2. Bitrix24 ‚Üí Webhook ‚Üí https://skysoft24.ru/meetRiedeBot/index.php
3. –ë–æ—Ç ‚Üí –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram –≥—Ä—É–ø–ø—É —Å –∫–Ω–æ–ø–∫–∞–º–∏
4. –í–æ–¥–∏—Ç–µ–ª–∏ ‚Üí –ù–µ —Ä–µ–∞–≥–∏—Ä—É—é—Ç (30 –º–∏–Ω—É—Ç)
5. Bitrix24 ‚Üí Webhook —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞
6. –ë–æ—Ç ‚Üí –ï—Å–ª–∏ –Ω–µ—Ç –≤–æ–¥–∏—Ç–µ–ª—è ‚Üí –°—Ç–∞–¥–∏—è = NEW
7. –ú–µ–Ω–µ–¥–∂–µ—Ä ‚Üí –í–∏–¥–∏—Ç —á—Ç–æ –∑–∞—è–≤–∫–∞ –≤–µ—Ä–Ω—É–ª–∞—Å—å, –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å —É—Å–ª–æ–≤–∏—è
```

---

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Endpoint: https://skysoft24.ru/meetRiedeBot/index.php

**–ß—Ç–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:**
1. ‚úÖ –°–æ–±—ã—Ç–∏—è –æ—Ç Bitrix24 (ONCRMDEALUPDATE)
2. ‚úÖ Callback –∫–Ω–æ–ø–∫–∏ –æ—Ç Telegram
3. ‚úÖ –ü—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ dealId/stage

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –§–∞–π–ª: `/var/www/html/meetRiedeBot/logs/webhook_debug.log`
- –ö–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —Å timestamp
- –í–∏–¥–Ω—ã –≤—Å–µ —ç—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤:**
```bash
tail -f /var/www/html/meetRiedeBot/logs/webhook_debug.log
```

---

## üìä –°—Ç–∞–¥–∏–∏ —Å–¥–µ–ª–∫–∏

| ID | –ù–∞–∑–≤–∞–Ω–∏–µ | –î–µ–π—Å—Ç–≤–∏–µ –±–æ—Ç–∞ |
|----|----------|---------------|
| NEW | –ù–æ–≤–∞—è | –ù–∏—á–µ–≥–æ |
| PREPARATION | –ü–æ–∏—Å–∫ –≤–æ–¥–∏—Ç–µ–ª—è | **‚Üí –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ —á–∞—Ç** üì® |
| PREPAYMENT_INVOICE | –í–æ–¥–∏—Ç–µ–ª—å –ø—Ä–∏–Ω—è–ª | –î–µ—Ç–∞–ª–∏ –≤ –õ–° –≤–æ–¥–∏—Ç–µ–ª—é |
| EXECUTING | –ó–∞—è–≤–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è | –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π |
| FINAL_INVOICE | –ó–∞–≤–µ—Ä—à–µ–Ω–∞ | –ù–∏—á–µ–≥–æ |

---

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ endpoint
```bash
curl https://skysoft24.ru/meetRiedeBot/index.php
```
**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:** `OK - Webhook received`

### 2. –¢–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω–æ–π –∑–∞—è–≤–∫–æ–π
1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É –≤ Bitrix24
2. –ü–æ—Å—Ç–∞–≤—å—Ç–µ —Å—Ç–∞–¥–∏—é "–ü–æ–∏—Å–∫ –≤–æ–¥–∏—Ç–µ–ª—è" (PREPARATION)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram –≥—Ä—É–ø–ø—É - –¥–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
tail -50 /var/www/html/meetRiedeBot/logs/webhook_debug.log
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ webhook'–æ–≤ –≤ Bitrix24
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º ‚Üí –í–µ–±—Ö—É–∫–∏**
2. –ù–∞–π–¥–∏—Ç–µ –∏—Å—Ö–æ–¥—è—â–∏–µ webhook'–∏ –¥–ª—è ONCRMDEALUPDATE
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ URL = `https://skysoft24.ru/meetRiedeBot/index.php`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤—ã–∑–æ–≤–æ–≤

---

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: –°–æ–æ–±—â–µ–Ω–∏–µ –Ω–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –≤ Telegram

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –õ–æ–≥–∏ webhook: `tail -f /var/www/html/meetRiedeBot/logs/webhook_debug.log`
2. –ï—Å—Ç—å –ª–∏ –∑–∞–ø–∏—Å—å –æ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è ONCRMDEALUPDATE?
3. –ö–∞–∫–∞—è —Å—Ç–∞–¥–∏—è —É —Å–¥–µ–ª–∫–∏? –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å PREPARATION
4. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ Handler ID? –î–æ–ª–∂–µ–Ω –±—ã—Ç—å 3

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –†—É—á–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–∫–∏
cd /root/meetride
php send_deal.php <DEAL_ID>
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ó–∞—è–≤–∫–∞ –Ω–µ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
1. –ù–∞—Å—Ç—Ä–æ–µ–Ω –ª–∏ –≤—Ç–æ—Ä–æ–π webhook —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 30 –º–∏–Ω—É—Ç?
2. –ï—Å—Ç—å –ª–∏ –ª–æ–≥–∏ –æ –≤—ã–∑–æ–≤–µ —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç?
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–ª–µ ASSIGNED_BY_ID –≤ —Å–¥–µ–ª–∫–µ

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–¥–µ–ª–∫–∏
cd /root/meetride
php check_deal_status.php <DEAL_ID>
```

### –ü—Ä–æ–±–ª–µ–º–∞: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Å–∫–æ–ª—å–∫–æ webhook'–æ–≤ —Å –æ–¥–Ω–∏–º —Å–æ–±—ã—Ç–∏–µ–º

**–†–µ—à–µ–Ω–∏–µ:**
1. –í Bitrix24 ‚Üí –í–µ–±—Ö—É–∫–∏ ‚Üí –Ω–∞–π–¥–∏—Ç–µ –¥—É–±–ª–∏ ONCRMDEALUPDATE
2. –û—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Å Handler ID = 3
3. –ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É –≤ –∫–æ–¥ (—É–∂–µ –µ—Å—Ç—å!)

---

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
tail -50 /var/www/html/meetRiedeBot/logs/webhook_debug.log

# –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f /var/www/html/meetRiedeBot/logs/webhook_debug.log

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å PHP
php -l /var/www/html/meetRiedeBot/src/index.php

# –¢–µ—Å—Ç endpoint
curl https://skysoft24.ru/meetRiedeBot/index.php
```

### Telegram –±–æ—Ç—ã
- **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫:** 7992462078 (—Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ polling)
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è/–∫–Ω–æ–ø–∫–∏:** 7529690360 (—Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ webhook)

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ Webhook –æ—Ç Bitrix24 ‚Üí Telegram —á–∞—Ç
- ‚úÖ –ö–Ω–æ–ø–∫–∏ –≤ Telegram ‚Üí Bitrix24
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–æ–∫ –Ω–∞ —Å—Ç–∞–¥–∏–∏ PREPARATION
- ‚úÖ –û—Ç–∫–∞—Ç —á–µ—Ä–µ–∑ 30 –º–∏–Ω—É—Ç (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤—Ç–æ—Ä–æ–π webhook)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **Endpoint:** https://skysoft24.ru/meetRiedeBot/index.php
- **–õ–æ–≥–∏:** `/var/www/html/meetRiedeBot/logs/webhook_debug.log`
- **–ö–æ–¥:** `/var/www/html/meetRiedeBot/botManager.php`
- **Bitrix24:** https://meetride.bitrix24.ru/

---

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–∞ –Ω–∞:** 7 –æ–∫—Ç—è–±—Ä—è 2025



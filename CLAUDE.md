# MeetRide Bot - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è Claude

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**MeetRide Bot** ‚Äî —ç—Ç–æ Telegram-–±–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞—è–≤–∫–∞–º–∏ –Ω–∞ —Ç–∞–∫—Å–∏ —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π Bitrix24 CRM. –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –æ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏ –¥–æ –µ—ë –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è —Å–≤—è–∑—å –º–µ–∂–¥—É –¥–∏—Å–ø–µ—Ç—á–µ—Ä—Å–∫–æ–π –∏ –≤–æ–¥–∏—Ç–µ–ª—è–º–∏ —á–µ—Ä–µ–∑ Telegram.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞—è–≤–æ–∫** –≤ –æ–±—â–∏–π —á–∞—Ç –≤–æ–¥–∏—Ç–µ–ª–µ–π
- ‚úÖ **–ü—Ä–∏–Ω—è—Ç–∏–µ –∑–∞—è–≤–æ–∫** –ª—é–±—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏ –Ω–æ–≤—ã–º–∏)
- ‚úÖ **–ü–æ–ª–Ω—ã–π workflow** (–ü—Ä–∏–Ω—è—Ç—å ‚Üí –ù–∞—á–∞—Ç—å ‚Üí –ó–∞–≤–µ—Ä—à–∏—Ç—å/–û—Ç–º–µ–Ω–∏—Ç—å)
- ‚úÖ **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö** –ø–æ–ª–µ–π –∑–∞—è–≤–∫–∏
- ‚úÖ **–°–∏—Å—Ç–µ–º–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π** –∑–∞ —á–∞—Å –¥–æ –ø–æ–µ–∑–¥–∫–∏
- ‚úÖ **–ó–∞—â–∏—Ç–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤** (–ø–∞—Å—Å–∞–∂–∏—Ä—ã —Ç–æ–ª—å–∫–æ –≤ –ª–∏—á–∫—É –≤–æ–¥–∏—Ç–µ–ª—é)

## üèóÔ∏è –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

### Backend
- **PHP 7.4+** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è
- **Bitrix24 REST API** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CRM —Å–∏—Å—Ç–µ–º–æ–π
- **Telegram Bot API** ‚Äî –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Telegram

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **Webhook** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –æ—Ç Bitrix24 –∏ Telegram
- **Linux Server** ‚Äî —Ö–æ—Å—Ç–∏–Ω–≥ –Ω–∞ Ubuntu/Debian
- **Apache/Nginx** ‚Äî –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
- **Cron** ‚Äî –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á –¥–ª—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π

### –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **Longman\TelegramBot** ‚Äî PHP SDK –¥–ª—è Telegram Bot API
- **CRest** ‚Äî –∫–ª–∏–µ–Ω—Ç –¥–ª—è Bitrix24 REST API
- **Carbon** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–µ–º
- **Guzzle HTTP** ‚Äî HTTP –∫–ª–∏–µ–Ω—Ç

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
meetride/
‚îú‚îÄ‚îÄ üìÑ –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ botManager.php                    # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞ (–∫–ª–∞—Å—Å Store\botManager)
‚îÇ   ‚îú‚îÄ‚îÄ webhook_stage3.php               # Webhook –¥–ª—è —Å—Ç–∞–¥–∏–∏ PREPAYMENT_INVOICE
‚îÇ   ‚îú‚îÄ‚îÄ src/index.php                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –¥–ª—è webhook'–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ simple_test.php                  # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ üîî –°–∏—Å—Ç–µ–º–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ reminder_scheduler.php           # –û—Å–Ω–æ–≤–Ω–æ–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ reminder_scheduler_simple.php    # –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è cron
‚îÇ   ‚îî‚îÄ‚îÄ send_missed_notifications.php    # –û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îÇ
‚îú‚îÄ‚îÄ üõ†Ô∏è –°–∫—Ä–∏–ø—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ switch_environment.sh        # –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ç–µ—Å—Ç/–ø—Ä–æ–¥
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ setup-test-environment.sh    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ deploy-to-test.sh           # –î–µ–ø–ª–æ–π –≤ —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ä–µ–¥—É
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sync-to-production.sh       # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ø—Ä–æ–¥–∞–∫—à–Ω–æ–º
‚îÇ   ‚îú‚îÄ‚îÄ run_bot.sh                      # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ monitor_bot.sh                  # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ setup_cron.sh                   # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron –∑–∞–¥–∞—á
‚îÇ
‚îú‚îÄ‚îÄ üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ README.md                        # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ WORKFLOW.md                      # –û–ø–∏—Å–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ USAGE.md                        # –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
‚îÇ   ‚îú‚îÄ‚îÄ TESTING_CHECKLIST.md            # –ß–µ–∫-–ª–∏—Å—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ –ò–ù–°–¢–†–£–ö–¶–ò–Ø_–ü–û_–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ.md   # –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
‚îÇ
‚îú‚îÄ‚îÄ üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ meetride-bot/                    # –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_bot_functions.php       # –¢–µ—Å—Ç—ã —Ñ—É–Ω–∫—Ü–∏–π –±–æ—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test_webhook_safe.php        # –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ webhook'–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ simple_test.php              # –ü—Ä–æ—Å—Ç—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ logs/                           # –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã
‚îÇ       ‚îú‚îÄ‚îÄ webhook_debug.log           # –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ª–æ–≥–∏ webhook'–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ bots.log                    # –õ–æ–≥–∏ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–æ–≤
‚îÇ       ‚îî‚îÄ‚îÄ reminder_scheduler.log      # –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
‚îÇ
‚îú‚îÄ‚îÄ ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.example.php          # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ composer.json                   # PHP –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt                # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–¥–ª—è –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤)
‚îÇ
‚îî‚îÄ‚îÄ üìä –î–∞–Ω–Ω—ã–µ
    ‚îú‚îÄ‚îÄ vendor/                         # PHP –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (Composer)
    ‚îú‚îÄ‚îÄ src/crest/                      # Bitrix24 REST API –∫–ª–∏–µ–Ω—Ç
    ‚îî‚îÄ‚îÄ logs/                          # –õ–æ–≥–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. –ö–ª–∞—Å—Å `Store\botManager`
–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å —Å–∏—Å—Ç–µ–º—ã, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤—Å—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É:

#### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø–æ–ª–µ–π Bitrix24:
```php
// –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è –∑–∞—è–≤–∫–∏
public const DRIVER_ID_FIELD = 'UF_CRM_1751272181';
public const DRIVER_TELEGRAM_ID_FIELD = 'UF_CRM_1751185017761';
public const ADDRESS_FROM_FIELD = 'UF_CRM_1751269147414';
public const ADDRESS_TO_FIELD = 'UF_CRM_1751269175432';
public const TRAVEL_DATE_TIME_FIELD = 'UF_CRM_1751269222959';
public const PASSENGERS_FIELD = 'UF_CRM_1751271798896';

// SERVICE –ø–æ–ª—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
public const DRIVER_SUM_FIELD_SERVICE = 'UF_CRM_1751638441407';
public const ADDRESS_FROM_FIELD_SERVICE = 'UF_CRM_1751638512';
// ... –∏ –¥—Ä—É–≥–∏–µ SERVICE –ø–æ–ª—è
```

#### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Å—Ç–∞–¥–∏–π:
```php
public const NEW_DEAL_STAGE_ID = 'NEW';
public const DRIVER_CHOICE_STAGE_ID = 'PREPARATION';
public const TRAVEL_STARTED_STAGE_ID = 'EXECUTING';
public const FINISH_STAGE_ID = 'FINAL_INVOICE';
public const DRIVERS_GROUP_CHAT_ID = '-1002544521661'; // –ë–æ–µ–≤–∞—è –≥—Ä—É–ø–ø–∞
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
- `newDealMessage($dealid, $telegram)` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–æ–≤–æ–π –∑–∞—è–≤–∫–∏ –≤ –≥—Ä—É–ø–ø—É
- `buttonHandle($callbackData, $telegram, $update)` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫
- `driverAcceptHandle($dealId, $telegram, $update)` ‚Äî –ø—Ä–∏–Ω—è—Ç–∏–µ –∑–∞—è–≤–∫–∏ –≤–æ–¥–∏—Ç–µ–ª–µ–º
- `dealChangeHandle($dealId, $telegram)` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞—è–≤–∫–∏
- `sendPrivateMessageToDriver($deal, $telegram)` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–µ—Ç–∞–ª–µ–π –≤–æ–¥–∏—Ç–µ–ª—é
- `orderTextForGroup($deal, $driverName)` ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –≥—Ä—É–ø–ø—ã
- `orderTextForDriver($deal)` ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è –≤–æ–¥–∏—Ç–µ–ª—è
- `formatDateTime($dateString)` ‚Äî —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏

### 2. Webhook –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
- **`src/index.php`** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π webhook –¥–ª—è —Å–æ–±—ã—Ç–∏–π Bitrix24
- **`webhook_stage3.php`** ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π webhook –¥–ª—è —Å—Ç–∞–¥–∏–∏ PREPAYMENT_INVOICE

### 3. –°–∏—Å—Ç–µ–º–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- **`reminder_scheduler.php`** ‚Äî –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
- **Cron –∑–∞–¥–∞—á–∏** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –∑–∞ —á–∞—Å –¥–æ –ø–æ–µ–∑–¥–∫–∏

### 4. –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- **`switch_environment.sh`** ‚Äî –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É —Ç–µ—Å—Ç–æ–≤–æ–π –∏ –±–æ–µ–≤–æ–π —Å—Ä–µ–¥–æ–π
- **`deploy-to-test.sh`** ‚Äî –¥–µ–ø–ª–æ–π –≤ —Ç–µ—Å—Ç–æ–≤—É—é —Å—Ä–µ–¥—É
- **`setup-test-environment.sh`** ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥—ã

## üîÑ –ß–∞—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏

### 1. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ä–µ–¥—ã (—Ç–µ—Å—Ç/–ø—Ä–æ–¥)
```bash
# –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—É—é –≥—Ä—É–ø–ø—É
./scripts/switch_environment.sh test

# –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –±–æ–µ–≤—É—é –≥—Ä—É–ø–ø—É  
./scripts/switch_environment.sh production
```

### 2. –î–µ–ø–ª–æ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
cp /root/meetride/botManager.php /var/www/html/meetRiedeBot/botManager.php

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
php -l /var/www/html/meetRiedeBot/botManager.php
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
```bash
# –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Å—Ç—ã—Ö —Ç–µ—Å—Ç–æ–≤
php simple_test.php

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –±–æ—Ç–∞
php meetride-bot/test_bot_functions.php

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ webhook'–æ–≤
php meetride-bot/test_webhook_safe.php
```

### 4. –û—Ç–ª–∞–¥–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ webhook'–æ–≤
tail -f /var/www/html/meetRiedeBot/logs/webhook_debug.log

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –±–æ—Ç–æ–≤
tail -f logs/bots.log

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞
./monitor_bot.sh
```

### 5. –†–∞–±–æ—Ç–∞ —Å –∑–∞—è–≤–∫–∞–º–∏
```php
// –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞—è–≤–∫–∏
$dealId = 815;
$telegram = new \Telegram\Bot\Api('BOT_TOKEN');
botManager::newDealMessage($dealId, $telegram);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞—è–≤–∫–∏
botManager::dealChangeHandle($dealId, $telegram);
```

### 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook'–æ–≤ Bitrix24
- **URL webhook:** `https://skysoft24.ru/meetRiedeBot/index.php`
- **–°–æ–±—ã—Ç–∏—è:** `ONCRMDEALUPDATE`
- **–°—Ç–∞–¥–∏–∏:** `PREPARATION`, `PREPAYMENT_INVOICE`

### 7. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–æ–π –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
```bash
# –ó–∞–ø—É—Å–∫ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
php reminder_scheduler_simple.php

# –û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
php send_missed_notifications.php

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
*/5 * * * * /usr/bin/php /root/meetride/reminder_scheduler_simple.php
```

### 8. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞
./deploy/backup.sh

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞
./deploy/backup.sh restore
```

## üö® –í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- **–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å:** –ü–∞—Å—Å–∞–∂–∏—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ª–∏—á–∫–µ –≤–æ–¥–∏—Ç–µ–ª—é
- **–í–∞–ª–∏–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –≤–æ–¥–∏—Ç–µ–ª—è –Ω–∞ –ø—Ä–∏–Ω—è—Ç–∏–µ –∑–∞—è–≤–∫–∏
- **–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–∏–Ω—è—Ç–∏—è –∑–∞—è–≤–æ–∫

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ö—ç—à —Å–¥–µ–ª–æ–∫ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:** Webhook'–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:** Graceful handling –≤—Å–µ—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- **Fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã:** –†–µ–∑–µ—Ä–≤–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –ø—Ä–∏ —Å–±–æ—è—Ö
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `/var/www/html/meetRiedeBot/logs/webhook_debug.log`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é: `php simple_test.php`
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å webhook: `php meetride-bot/test_webhook_safe.php`
4. –°–≤—è–∑–∞—Ç—å—Å—è —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º –¥–ª—è —Ä–µ—à–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤


